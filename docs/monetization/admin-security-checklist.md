# چک‌لیست بازبینی امنیت پنل ادمین و لاگ‌های حساس

> آخرین به‌روزرسانی: 2026-02-06
> بازه بازبینی: `YYYY-MM`
> مسئول اجرا: `@owner`
> مسئول تایید: `@reviewer`

## 1) کنترل دسترسی پنل ادمین

- [ ] فقط نقش‌های مجاز به مسیرهای ادمین دسترسی دارند.
- [ ] مسیرهای ادمین بدون نشست معتبر، redirect/block می‌شوند.
- [ ] session timeout و logout اجباری بررسی شده است.
- [ ] هیچ endpoint ادمین بدون احراز هویت قابل فراخوانی نیست.

## 2) امنیت API و ورودی‌ها

- [ ] همه endpointهای ادمین ورودی‌سنجی دارند.
- [ ] محافظت CSRF در مسیرهای حساس فعال است.
- [ ] rate limit برای endpointهای حساس فعال و پایش‌پذیر است.
- [ ] خطاها اطلاعات حساس (stack/token/secret) را افشا نمی‌کنند.

## 3) لاگ‌برداری و لاگ‌های حساس

- [ ] در لاگ‌ها داده حساس خام (token, password, cookie, secret) وجود ندارد.
- [ ] PII فقط در صورت ضرورت عملیاتی و به‌صورت حداقلی ثبت می‌شود.
- [ ] retention لاگ‌ها تعریف شده و با سیاست حذف تاریخچه همسو است.
- [ ] دسترسی به لاگ‌های حساس محدود، ثبت‌شده و قابل ممیزی است.

## 4) CSP، nonce و اسکریپت‌ها

- [ ] هدر CSP از `proxy.ts` اعمال می‌شود.
- [ ] JSON-LDها با nonce معتبر inject می‌شوند.
- [ ] اسکریپت runtime خارجی جدید اضافه نشده است.
- [ ] `unsafe-inline` و `unsafe-eval` وارد CSP نشده‌اند.

## 5) رضایت تبلیغات و تحلیل‌گر

- [ ] رندر تبلیغات قبل از رضایت کاربر رخ نمی‌دهد.
- [ ] analytics بدون رضایت یا بدون `ANALYTICS_INGEST_SECRET` (وقتی فعال است) ingest نمی‌شود.
- [ ] مسیرهای consent در سناریوهای deny/accept تست شده‌اند.

## 6) شواهد بازبینی (الزامی)

- [ ] لینک PR بازبینی: `...`
- [ ] لینک اجرای تست‌ها (`pnpm ci:quick` و در صورت نیاز E2E): `...`
- [ ] خلاصه یافته‌ها و اقدام اصلاحی ثبت شد: `...`

## 7) خروجی نهایی بازبینی

- وضعیت: `pass | pass-with-actions | fail`
- یافته‌های بحرانی: `0/1/+`
- اقدامات follow-up:

1. `...`
2. `...`
